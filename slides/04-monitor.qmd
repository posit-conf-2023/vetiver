---
title: "4 - Monitor your model"
subtitle: "Deploy and maintain models with vetiver"
format:
  revealjs: 
    slide-number: true
    footer: <https://posit-conf-2023.github.io/vetiver>
    preview-links: auto
    incremental: true
    theme: [default]
    width: 1280
    height: 720
knitr:
  opts_chunk: 
    echo: true
    collapse: true
    comment: "#>"
---

```{r}
#| include: false
#| file: setup.R
```

## Plan for this workshop

::: nonincremental
-   *Versioning*
    -   Managing change in models ✅
-   *Deploying*
    -   Putting models in REST APIs 🎯
-   *Monitoring*
    -   Tracking model performance 👀
:::

## My model is performing well!

. . .

👩🏼‍🔧 My model returns predictions quickly, doesn't use too much memory or processing power, and doesn't have outages.

. . .

::: {.callout-tip icon=false}

## Metrics

- latency
- memory and CPU usage
- uptime


:::

## My model is performing well! 

. . .

👩🏽‍🔬 My model returns predictions that are close to the true values for the predicted quantity.

. . .

::: {.callout-tip icon=false}

## Metrics

- accuracy
- ROC AUC
- F1 score
- RMSE
- log loss

:::


## Model drift 📉 {auto-animate=true}

::: {.r-fit-text}
DATA drift
:::

## Model drift 📉 {auto-animate=true}

::: {.r-fit-text}
CONCEPT drift
:::

## Your turn 🏺 {transition="slide-in"}

::: {.callout-note icon=false}

## Activity

Using our Chicago data, what could be an example of data drift? Concept drift?

:::

```{r}
#| echo: false
library(countdown)
countdown(minutes = 5)
```

## Learn more about model monitoring on tktk

Come hear Julia's talk on reliable maintenance of ML models on tktk in tktk!

# Monitor your models' **inputs**

tktk

# Monitor your models' **outputs**

tktk

# Feedback loops 🔁

Deployment of an ML model may *alter* the training data 

- Movie recommendation systems on Netflix, Disney+, Hulu, etc
- Identifying fraudulent credit card transactions at Stripe
- Recidivism models

::: footer
[*Building Machine Learning Pipelines* by Hapke & Nelson](https://www.oreilly.com/library/view/building-machine-learning/9781492053187/)
:::

# Feedback loops can have **unexpected consequences**

::: footer
[*Building Machine Learning Pipelines* by Hapke & Nelson](https://www.oreilly.com/library/view/building-machine-learning/9781492053187/)
:::

## Feedback loops 🔁

- Users take some action as a result of a prediction
- Users rate or correct the quality of a prediction
- Produce annotations (crowdsource or expert)
- Produce feedback automatically

::: footer
[*Building Machine Learning Pipelines* by Hapke & Nelson](https://www.oreilly.com/library/view/building-machine-learning/9781492053187/)
:::

## Your turn 🏺 {transition="slide-in"}

::: {.callout-note icon=false}

## Activity

What is a possible feedback loop for the Chicago inspections data?

Do you think your example would be harmful or helpful?

:::

```{r}
#| echo: false
library(countdown)
countdown(minutes = 5)
```


## Connect model metrics to business outcomes

tktk

## Possible model monitoring artifacts

- Adhoc analysis that you post in Slack
- Report that you share in Google Drive
- Fully automated dashboard published to Posit Connect

::: footer
[5 Levels of MLOps Maturity](https://www.nannyml.com/blog/5-levels-of-mlops-maturity)
:::

## Possible model monitoring artifacts

![](images/vetiver-templates.png){fig-align="center"}

## Your turn 🏺 {transition="slide-in"}

::: {.callout-note icon=false}

## Activity

Create a Quarto report or R Markdown dashboard for model monitoring.

Publish your document to Connect.

:::

```{r}
#| echo: false
library(countdown)
countdown(minutes = 15)
```


## 

::: r-fit-text
We made it! 🎉
:::

## Your turn 🏺 {transition="slide-in"}

::: {.callout-note icon=false}

## Activity

What is one thing you learned that surprised you?

What is one thing you learned that you plan to use?

:::

```{r}
#| echo: false
library(countdown)
countdown(minutes = 5)
```

## Resources to keep learning

-   Documentation at <https://vetiver.rstudio.com/>

-   Isabel's talk from rstudio::conf() 2022 on [Demystifying MLOps](https://www.rstudio.com/conference/2022/talks/demystifying-mlops/)


-   End-to-end demos from Posit Solution Engineering in [R](https://github.com/sol-eng/bike_predict) and [Python](https://github.com/sol-eng/bike_predict_python)

-   Are you on the right track with your MLOps system? Use the rubric in ["The ML Test Score: A Rubric for ML Production Readiness and Technical Debt Reduction"](https://research.google/pubs/pub46555/) by Breck et al (2017)

- Want to learn about how MLOps is being practiced? Read one of our favorite 😍 papers of the last year, ["Operationalizing Machine Learning: An Interview Study"](https://arxiv.org/abs/2209.09125) by Shankar et al (20222)

. . .

Follow Posit and/or us on your preferred social media for updates!

# Submit feedback before you leave 🗳️

[feedback-url-goes-here](tktk)

Your feedback is crucial! Data from the survey informs curriculum and format decisions for future conf workshops and we really appreciate you taking the time to provide it.
