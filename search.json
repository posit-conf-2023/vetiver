[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Deploy and maintain models with vetiver",
    "section": "",
    "text": "These are the materials for a one-day workshop on MLOps with vetiver on Monday, 18 Sept at posit::conf 2023!\nMany data scientists understand what goes into training a machine learning or statistical model, but creating a strategy to deploy and maintain that model can be daunting. In this workshop, learn what MLOps (machine learning operations) is, what principles can be used to create a practical MLOps strategy, and what kinds of tasks and components are involved. We‚Äôll use vetiver, a framework for MLOps tasks in Python and R, to version, deploy, and monitor the models you have trained and want to deploy and maintain in production reliably and efficiently."
  },
  {
    "objectID": "index.html#welcome",
    "href": "index.html#welcome",
    "title": "Deploy and maintain models with vetiver",
    "section": "",
    "text": "These are the materials for a one-day workshop on MLOps with vetiver on Monday, 18 Sept at posit::conf 2023!\nMany data scientists understand what goes into training a machine learning or statistical model, but creating a strategy to deploy and maintain that model can be daunting. In this workshop, learn what MLOps (machine learning operations) is, what principles can be used to create a practical MLOps strategy, and what kinds of tasks and components are involved. We‚Äôll use vetiver, a framework for MLOps tasks in Python and R, to version, deploy, and monitor the models you have trained and want to deploy and maintain in production reliably and efficiently."
  },
  {
    "objectID": "index.html#is-this-workshop-for-me",
    "href": "index.html#is-this-workshop-for-me",
    "title": "Deploy and maintain models with vetiver",
    "section": "Is this workshop for me?",
    "text": "Is this workshop for me?\nWe expect participants to have exposure to basic modeling and machine learning practice, but NOT expert familiarity with advanced ML or MLOps topics. This workshop is for you if you:\n\nhave intermediate R or Python knowledge (this will be a ‚Äúchoose your own adventure‚Äù workshop where you can work through the exercises in either R or Python)\ncan read data from CSV and other flat files, transform and reshape data, and make a wide variety of graphs\ncan fit a model to data with your modeling framework of choice wide variety of graphs"
  },
  {
    "objectID": "index.html#preparation",
    "href": "index.html#preparation",
    "title": "Deploy and maintain models with vetiver",
    "section": "Preparation",
    "text": "Preparation\nPlease join the workshop with a computer that has the following installed:\ntktk\nJoin us on GitHub Discussions to ask questions and share ideas."
  },
  {
    "objectID": "index.html#schedule",
    "href": "index.html#schedule",
    "title": "Deploy and maintain models with vetiver",
    "section": "Schedule",
    "text": "Schedule\nQuarto files for working along are available on GitHub.\n\n\n\nTime\nActivity\n\n\n\n\n09:00 - 10:30\nIntroduction\n\n\n10:30 - 11:00\nCoffee break\n\n\n11:00 - 12:30\nDeploy your model\n\n\n12:30 - 13:30\nLunch break\n\n\n13:30 - 15:00\nDeeper into deployment\n\n\n15:00 - 15:30\nCoffee break\n\n\n15:30 - 17:00\nMonitor your model"
  },
  {
    "objectID": "index.html#instructors",
    "href": "index.html#instructors",
    "title": "Deploy and maintain models with vetiver",
    "section": "Instructors",
    "text": "Instructors\nJulia Silge is a software engineer at Posit PBC focusing on open source MLOps tools, as well as an author and international keynote speaker. Julia loves making beautiful charts, Jane Austen, and her two cats.\nIsabel Zimmerman is also a software engineer on the open source team at Posit PBC, where she works on building MLOps frameworks. When she‚Äôs not geeking out over new data science techniques, she can be found hanging out with her dog or watching Marvel movies."
  },
  {
    "objectID": "index.html#acknowledgments",
    "href": "index.html#acknowledgments",
    "title": "Deploy and maintain models with vetiver",
    "section": "Acknowledgments",
    "text": "Acknowledgments\n\nThis website, including the slides, is made with Quarto. Please submit an issue on the GitHub repo for this workshop if you find something that could be fixed or improved."
  },
  {
    "objectID": "index.html#reuse-and-licensing",
    "href": "index.html#reuse-and-licensing",
    "title": "Deploy and maintain models with vetiver",
    "section": "Reuse and licensing",
    "text": "Reuse and licensing\n\n This work is licensed under a Creative Commons Attribution 4.0 International License."
  },
  {
    "objectID": "slides/01-introduction.html#who-are-you",
    "href": "slides/01-introduction.html#who-are-you",
    "title": "1 - Introduction",
    "section": "Who are you?",
    "text": "Who are you?\n\nYou have intermediate R or Python knowledge\nYou can read data from CSV and other flat files, transform and reshape data, and make a wide variety of graphs\nYou can fit a model to data with your modeling framework of choice wide variety of graphs\nYou have exposure to basic modeling and machine learning practice\nYou do not need expert familiarity with advanced ML or MLOps topics"
  },
  {
    "objectID": "slides/01-introduction.html#who-are-we",
    "href": "slides/01-introduction.html#who-are-we",
    "title": "1 - Introduction",
    "section": "Who are we?",
    "text": "Who are we?\n\n\n\n\n\n @isabelizimm\n @isabelizimm@fosstodon.org\n isabelizimm.github.io\n\n\n\n\n @juliasilge\n @juliasilge@fosstodon.org\n youtube.com/juliasilge\n juliasilge.com"
  },
  {
    "objectID": "slides/01-introduction.html#plan-for-this-workshop",
    "href": "slides/01-introduction.html#plan-for-this-workshop",
    "title": "1 - Introduction",
    "section": "Plan for this workshop",
    "text": "Plan for this workshop\n\nVersioning\n\nManaging change in models ‚úÖ\n\nDeploying\n\nPutting models in REST APIs üéØ\n\nMonitoring\n\nTracking model performance üëÄ"
  },
  {
    "objectID": "slides/01-introduction.html#what-is-machine-learning",
    "href": "slides/01-introduction.html#what-is-machine-learning",
    "title": "1 - Introduction",
    "section": "What is machine learning?",
    "text": "What is machine learning?\n\n\nIllustration credit: https://vas3k.com/blog/machine_learning/"
  },
  {
    "objectID": "slides/01-introduction.html#what-is-machine-learning-1",
    "href": "slides/01-introduction.html#what-is-machine-learning-1",
    "title": "1 - Introduction",
    "section": "What is machine learning?",
    "text": "What is machine learning?\n\n\nIllustration credit: Chapter 1 of Tidy Modeling with R"
  },
  {
    "objectID": "slides/01-introduction.html#mlops-is",
    "href": "slides/01-introduction.html#mlops-is",
    "title": "1 - Introduction",
    "section": "MLOps is‚Ä¶",
    "text": "MLOps is‚Ä¶"
  },
  {
    "objectID": "slides/01-introduction.html#mlops-is-1",
    "href": "slides/01-introduction.html#mlops-is-1",
    "title": "1 - Introduction",
    "section": "MLOps is‚Ä¶",
    "text": "MLOps is‚Ä¶\na set of practices to deploy and maintain machine learning models in production reliably and efficiently"
  },
  {
    "objectID": "slides/01-introduction.html#mlops-with-vetiver",
    "href": "slides/01-introduction.html#mlops-with-vetiver",
    "title": "1 - Introduction",
    "section": "MLOps with vetiver",
    "text": "MLOps with vetiver\n\nVetiver, the oil of tranquility, is used as a stabilizing ingredient in perfumery to preserve more volatile fragrances."
  },
  {
    "objectID": "slides/01-introduction.html#your-turn",
    "href": "slides/01-introduction.html#your-turn",
    "title": "1 - Introduction",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\n\nActivity\n\n\nWhat language does your team use for machine learning?\nWhat kinds of models do you commonly use?\nHave you ever deployed a model?\n\n\n\n\n\n\n‚àí+\n03:00"
  },
  {
    "objectID": "slides/01-introduction.html#chicago-food-inspections-data",
    "href": "slides/01-introduction.html#chicago-food-inspections-data",
    "title": "1 - Introduction",
    "section": "Chicago food inspections data",
    "text": "Chicago food inspections data\n\n\nThe city of Chicago offers programmatic access to health code inspections of restaurants\nCan certain measurements be used to predict inspection outcome?\nData from Chicago Department of Public Health, available at https://data.cityofchicago.org/\n\n\n\nImage by Christopher Alvarenga"
  },
  {
    "objectID": "slides/01-introduction.html#inspection-results",
    "href": "slides/01-introduction.html#inspection-results",
    "title": "1 - Introduction",
    "section": "Inspection results",
    "text": "Inspection results\n\nN = 20414\nA class outcome, results\nOther variables to use for prediction:\n\nfacility_type is a nominal predictor\nrisk is a nominal (or maybe ordinal) predictor\ntotal_violations is a numeric predictor\ninspection_date is a date predictor\n\n\n\nR\n\nlibrary(arrow)\npath &lt;- here::here(\"data\", \"inspections.parquet\")\ninspections &lt;- read_parquet(path)\n\nPython\n\nimport pandas as pd\ninspections = pd.read_parquet('../data/inspections.parquet')"
  },
  {
    "objectID": "slides/01-introduction.html#inspection-results-1",
    "href": "slides/01-introduction.html#inspection-results-1",
    "title": "1 - Introduction",
    "section": "Inspection results",
    "text": "Inspection results\n\n\n\n\n\n\n  \n    \n    \n      results\n      inspection_date\n      aka_name\n      facility_type\n      risk\n      total_violations\n    \n  \n  \n    PASS\n2020-06-15\nLA ESTRELLA MINI MART\nGROCERY STORE\nRISK 2 (MEDIUM)\n9\n    PASS\n2022-03-04\nDR. MLK, JR. PARK AND FAMILY ENTERTAINMENT CENTER\nRESTAURANT\nRISK 2 (MEDIUM)\n33\n    PASS\n2020-07-21\nCARLS RED HOTS\nRESTAURANT\nRISK 1 (HIGH)\n3\n    FAIL\n2019-01-18\nSALERNO'S PIZZERIA\nRESTAURANT\nRISK 1 (HIGH)\n29\n    FAIL\n2019-07-29\nMIKEY B INC.\nRESTAURANT\nRISK 2 (MEDIUM)\n9\n    FAIL\n2018-09-28\nBEEF AND BRANDY RESTAURANT\nRESTAURANT\nRISK 1 (HIGH)\n89\n    PASS\n2022-12-21\nGOOGLE\nRESTAURANT\nRISK 1 (HIGH)\n2\n    FAIL\n2020-04-30\nSPIRITS BEVERAGE CENTER\nGROCERY STORE\nRISK 3 (LOW)\n113\n    FAIL\n2019-03-26\nLEAH'S PANCAKE HOUSE\nRESTAURANT\nRISK 1 (HIGH)\n38\n    FAIL\n2019-08-12\nCHIU QUON BAKERY\nBAKERY\nRISK 1 (HIGH)\n16\n    PASS\n2022-09-30\nLAS FUENTES\nRESTAURANT\nRISK 1 (HIGH)\n136\n    PASS\n2022-03-25\nPINT\nRESTAURANT\nRISK 1 (HIGH)\n77\n    FAIL\n2019-06-10\nMACHU PICCHU\nRESTAURANT\nRISK 1 (HIGH)\n52\n    FAIL\n2020-03-23\nBOT BAKERY\nBAKERY\nRISK 2 (MEDIUM)\n10\n    PASS\n2020-06-15\nHERO COFFEE BAR\nRESTAURANT\nRISK 2 (MEDIUM)\n22"
  },
  {
    "objectID": "slides/01-introduction.html#your-turn-1",
    "href": "slides/01-introduction.html#your-turn-1",
    "title": "1 - Introduction",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nExplore the inspections data on your own!\n\n\nWhat‚Äôs the distribution of the outcome results?\nWhat‚Äôs the distribution of the numeric variable total_violations?\nHow do results differ across facility type?\n\n\nShare something you noticed with your neighbor.\n\n\n\n\n\n\n‚àí+\n08:00\n\n\n\n\nMake a plot or summary and then share with neighbor"
  },
  {
    "objectID": "slides/01-introduction.html#section-1",
    "href": "slides/01-introduction.html#section-1",
    "title": "1 - Introduction",
    "section": "",
    "text": "library(tidyverse)\ninspections |&gt; \n  group_by(inspection_date = floor_date(inspection_date, unit = \"month\")) |&gt; \n  summarise(results = mean(results == \"PASS\")) |&gt; \n  ggplot(aes(inspection_date, results)) +\n  geom_line(alpha = 0.8, linewidth = 1.5) +\n  scale_y_continuous(labels = scales::percent) +\n  labs(y = \"% of inspections that have a PASS result\", x = NULL)"
  },
  {
    "objectID": "slides/01-introduction.html#section-2",
    "href": "slides/01-introduction.html#section-2",
    "title": "1 - Introduction",
    "section": "",
    "text": "from plotnine import ggplot, aes, geom_boxplot, coord_flip\n(ggplot(inspections, aes('facility_type', 'total_violations', fill = 'facility_type')) \n  + geom_boxplot(alpha = 0.5, show_legend = False)\n  + coord_flip()\n)"
  },
  {
    "objectID": "slides/01-introduction.html#section-3",
    "href": "slides/01-introduction.html#section-3",
    "title": "1 - Introduction",
    "section": "",
    "text": "inspections |&gt;\n  ggplot(aes(inspection_date, total_violations, z = as.integer(results) - 1)) +\n  stat_summary_hex(alpha = 0.7) +\n  scale_fill_viridis_c(labels = scales::percent) +\n  labs(fill = \"% passed\")"
  },
  {
    "objectID": "slides/01-introduction.html#time-for-building-a-model",
    "href": "slides/01-introduction.html#time-for-building-a-model",
    "title": "1 - Introduction",
    "section": "Time for building a model!",
    "text": "Time for building a model!"
  },
  {
    "objectID": "slides/01-introduction.html#spend-your-data-budget",
    "href": "slides/01-introduction.html#spend-your-data-budget",
    "title": "1 - Introduction",
    "section": "Spend your data budget",
    "text": "Spend your data budget\nR\n\nlibrary(tidymodels)\nset.seed(123)\ninspect_split &lt;- initial_split(inspections, prop = 0.8)\ninspect_train &lt;- training(inspect_split)\ninspect_test &lt;- testing(inspect_split)\n\nPython\n\nfrom sklearn import model_selection\nimport numpy as np\nnp.random.seed(123)\ninspections['inspection_date'] = pd.to_datetime(inspections['inspection_date'])\ninspections['month'] = inspections['inspection_date'].dt.month\ninspections['year'] = inspections['inspection_date'].dt.year\nX, y = inspections.drop(columns=['aka_name', 'results', 'inspection_date']), inspections['results']\nX_train, X_test, y_train, y_test = model_selection.train_test_split(\n    X, y,\n    test_size = 0.2\n)"
  },
  {
    "objectID": "slides/01-introduction.html#fit-a-logistic-regression-model",
    "href": "slides/01-introduction.html#fit-a-logistic-regression-model",
    "title": "1 - Introduction",
    "section": "Fit a logistic regression model üöÄ",
    "text": "Fit a logistic regression model üöÄ\nOr your model of choice!\n\nRPython\n\n\n\ninspection_rec &lt;- \n  recipe(results ~ facility_type + risk + total_violations + inspection_date, \n         data = inspect_train) |&gt; \n  step_date(inspection_date, features = c(\"month\", \"year\"), keep_original_cols = FALSE)\n\ninspection_fit &lt;-\n  workflow(inspection_rec, logistic_reg()) |&gt; \n  fit(data = inspect_train)\n\n\n\n\nfrom sklearn import preprocessing, linear_model, pipeline, compose\n\ncategorical_features = ['facility_type', 'risk', 'month', 'year']\n\noe = compose.make_column_transformer(\n    (preprocessing.OrdinalEncoder(\n            handle_unknown=\"use_encoded_value\", unknown_value=-1),\n        categorical_features,),\n    remainder=\"passthrough\",\n).fit(X_train)\nlr = linear_model.LogisticRegression().fit(oe.transform(X_train), y_train)\ninspection_fit = pipeline.Pipeline([(\"ordinal_encoder\", oe), (\"random_forest\", lr)])"
  },
  {
    "objectID": "slides/01-introduction.html#your-turn-2",
    "href": "slides/01-introduction.html#your-turn-2",
    "title": "1 - Introduction",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nSplit your data in training and testing.\nFit a model to your training data.\n\n\n\n\n\n\n‚àí+\n05:00"
  },
  {
    "objectID": "slides/01-introduction.html#create-a-deployable-model-object",
    "href": "slides/01-introduction.html#create-a-deployable-model-object",
    "title": "1 - Introduction",
    "section": "Create a deployable model object",
    "text": "Create a deployable model object\nR\n\nlibrary(vetiver)\nv &lt;- vetiver_model(inspection_fit, \"inspection-result-rstats\")\nv\n#&gt; \n#&gt; ‚îÄ‚îÄ inspection-result-rstats ‚îÄ &lt;bundled_workflow&gt; model for deployment \n#&gt; A glm classification modeling workflow using 4 features\n\nPython\n\nfrom vetiver import VetiverModel\nv = VetiverModel(inspection_fit, \"inspection-result-python\", prototype_data = X_train)\nv.description\n#&gt; 'A scikit-learn Pipeline model'"
  },
  {
    "objectID": "slides/01-introduction.html#your-turn-3",
    "href": "slides/01-introduction.html#your-turn-3",
    "title": "1 - Introduction",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nCreate your vetiver model object.\nCheck out the default description that is created, and try out using a custom description.\nShow your custom description to your neighbor.\n\n\n\n\n\n\n‚àí+\n05:00"
  },
  {
    "objectID": "slides/01-introduction.html#pins",
    "href": "slides/01-introduction.html#pins",
    "title": "1 - Introduction",
    "section": "pins üìå",
    "text": "pins üìå\nThe pins package publishes data, models, and other R and Python objects, making it easy to share them across projects and with your colleagues.\n\n\n\n\n\n\n\nYou can pin objects to a variety of pin boards, including:\n\n\n\n\na local folder (like a network drive or even a temporary directory)\nPosit Connect\nAmazon S3\nAzure Storage\nGoogle Cloud"
  },
  {
    "objectID": "slides/01-introduction.html#version-your-model-1",
    "href": "slides/01-introduction.html#version-your-model-1",
    "title": "1 - Introduction",
    "section": "Version your model",
    "text": "Version your model\nLearn about the pins package for Python and for R\n\nPythonR\n\n\n\nfrom pins import board_temp\nfrom vetiver import vetiver_pin_write\n\nboard = board_temp(allow_pickle_read = True)\nvetiver_pin_write(board, v)\n#&gt; Model Cards provide a framework for transparent, responsible reporting. \n#&gt;  Use the vetiver `.qmd` Quarto template as a place to start, \n#&gt;  with vetiver.model_card()\n#&gt; Writing pin:\n#&gt; Name: 'inspection-result-python'\n#&gt; Version: 20230825T161739Z-d32c9\n\n\n\n\nlibrary(pins)\n\nboard &lt;- board_temp()\nboard |&gt; vetiver_pin_write(v)\n#&gt; Creating new version '20230825T161740Z-7abba'\n#&gt; Writing to pin 'inspection-result-rstats'\n#&gt; \n#&gt; Create a Model Card for your published model\n#&gt; ‚Ä¢ Model Cards provide a framework for transparent, responsible reporting\n#&gt; ‚Ä¢ Use the vetiver `.Rmd` template as a place to start"
  },
  {
    "objectID": "slides/01-introduction.html#your-turn-4",
    "href": "slides/01-introduction.html#your-turn-4",
    "title": "1 - Introduction",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nPin your vetiver model object to a temporary board.\nRetrieve the model metadata with pin_meta().\n\n\n\n\n\n\n‚àí+\n05:00"
  },
  {
    "objectID": "slides/01-introduction.html#version-your-model-2",
    "href": "slides/01-introduction.html#version-your-model-2",
    "title": "1 - Introduction",
    "section": "Version your model",
    "text": "Version your model\nR\n\nlibrary(pins)\nboard &lt;- board_temp()\nboard |&gt; vetiver_pin_write(v)\n\nPython\n\nfrom pins import board_temp\nfrom vetiver import vetiver_pin_write\n\nboard = board_temp(allow_pickle_read = True)\nvetiver_pin_write(board, v)"
  },
  {
    "objectID": "slides/01-introduction.html#version-your-model-3",
    "href": "slides/01-introduction.html#version-your-model-3",
    "title": "1 - Introduction",
    "section": "Version your model",
    "text": "Version your model\nR\n\nlibrary(pins)\nboard &lt;- board_connect()\nboard |&gt; vetiver_pin_write(v)\n\nPython\n\nfrom pins import board_connect\nfrom vetiver import vetiver_pin_write\nimport os\nfrom dotenv import load_dotenv\nload_dotenv()\n\napi_key = os.getenv(\"CO_API_KEY\")\nrsc_url = os.getenv(\"CO_RSC_URL\")\n\nboard = board_connect(server_url = rsc_url, api_key = api_key, allow_pickle_read = True)\nvetiver_pin_write(board, v)"
  },
  {
    "objectID": "slides/01-introduction.html#your-turn-5",
    "href": "slides/01-introduction.html#your-turn-5",
    "title": "1 - Introduction",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nPin your model to our Connect instance.\nTrain your model again, using a different ML algorithm (decision tree or random forest are good options).\nWrite this new version of your model to the same pin, and see what versions you have with pin_versions.\n\n\n\n\n\n\n‚àí+\n05:00\n\n\n\n\n\nhttps://posit-conf-2023.github.io/vetiver"
  },
  {
    "objectID": "slides/02-deploy.html#plan-for-this-workshop",
    "href": "slides/02-deploy.html#plan-for-this-workshop",
    "title": "2 - Deploy your model",
    "section": "Plan for this workshop",
    "text": "Plan for this workshop\n\n\nVersioning\n\nManaging change in models ‚úÖ\n\nDeploying\n\nPutting models in REST APIs üéØ\n\nMonitoring\n\nTracking model performance üëÄ"
  },
  {
    "objectID": "slides/02-deploy.html#fit-a-random-forest",
    "href": "slides/02-deploy.html#fit-a-random-forest",
    "title": "2 - Deploy your model",
    "section": "Fit a random forest üå≥üå¥üå≤üå≤üå¥üå≥üå¥üå≥üå≤",
    "text": "Fit a random forest üå≥üå¥üå≤üå≤üå¥üå≥üå¥üå≥üå≤\n\nRPython\n\n\n\nlibrary(tidyverse)\nlibrary(tidymodels)\nlibrary(arrow)\npath &lt;- here::here(\"data\", \"inspections.parquet\")\ninspections &lt;- read_parquet(path)\n\nset.seed(123)\ninspect_split &lt;- initial_split(inspections, prop = 0.8)\ninspect_train &lt;- training(inspect_split)\ninspect_test &lt;- testing(inspect_split)\n\ninspection_rec &lt;- \n  recipe(results ~ facility_type + risk + total_violations + inspection_date, \n         data = inspect_train) |&gt; \n  step_date(inspection_date, features = c(\"month\", \"year\"), keep_original_cols = FALSE)\n\ninspection_fit &lt;-\n  workflow(inspection_rec, rand_forest(mode = \"classification\", trees = 1e3)) |&gt; \n  fit(data = inspect_train)\n\n\n\n\nimport pandas as pd\nimport numpy as np\nfrom sklearn import preprocessing, ensemble, pipeline, compose, model_selection\n\ninspections = pd.read_parquet('../data/inspections.parquet')\ninspections['inspection_date'] = pd.to_datetime(inspections['inspection_date'])\ninspections['month'] = inspections['inspection_date'].dt.month\ninspections['year'] = inspections['inspection_date'].dt.year\n\ncategorical_features = ['facility_type', 'risk', 'month', 'year']\nX, y = inspections.drop(columns=['aka_name', 'results','inspection_date']), inspections['results']\nX_train, X_test, y_train, y_test = model_selection.train_test_split(\n    X, y,\n    stratify = y,\n    test_size = 0.2\n)\n\noe = compose.make_column_transformer(\n    (preprocessing.OrdinalEncoder(\n            handle_unknown=\"use_encoded_value\", unknown_value=-1),\n        categorical_features,),\n    remainder=\"passthrough\",\n).fit(X_train)\nrf = ensemble.RandomForestClassifier().fit(oe.transform(X_train), y_train)\ninspection_fit = pipeline.Pipeline([(\"ordinal_encoder\", oe), (\"random_forest\", rf)])"
  },
  {
    "objectID": "slides/02-deploy.html#create-your-vetiver-model-and-version",
    "href": "slides/02-deploy.html#create-your-vetiver-model-and-version",
    "title": "2 - Deploy your model",
    "section": "Create your vetiver model and version",
    "text": "Create your vetiver model and version\nR\n\nlibrary(vetiver)\nlibrary(pins)\n\nv &lt;- vetiver_model(inspect_fit, \"chicago-inspections-rstats\")\nboard &lt;- board_connect()\nboard |&gt; vetiver_pin_write(v)\n\nPython\n\nfrom vetiver import VetiverModel, vetiver_pin_write\nfrom pins import board_connect\nimport os\nfrom dotenv import load_dotenv\nload_dotenv()\napi_key = os.getenv(\"CO_API_KEY\")\nrsc_url = os.getenv(\"CO_RSC_URL\")\n\nv = VetiverModel(inspection_fit, \"chicago-inspections-python\", ptype_data = X_train)\nboard = board_connect(server_url = rsc_url, api_key = api_key, allow_pickle_read = True)\nvetiver_pin_write(board, v)"
  },
  {
    "objectID": "slides/02-deploy.html#make-it-easy-to-do-the-right-thing",
    "href": "slides/02-deploy.html#make-it-easy-to-do-the-right-thing",
    "title": "2 - Deploy your model",
    "section": "Make it easy to do the right thing",
    "text": "Make it easy to do the right thing\n\nRobust and human-friendly checking of new data\nTrack and document software dependencies of models\nModel cards for transparent, responsible reporting"
  },
  {
    "objectID": "slides/02-deploy.html#make-it-easy-to-do-the-right-thing-1",
    "href": "slides/02-deploy.html#make-it-easy-to-do-the-right-thing-1",
    "title": "2 - Deploy your model",
    "section": "Make it easy to do the right thing",
    "text": "Make it easy to do the right thing"
  },
  {
    "objectID": "slides/02-deploy.html#your-turn",
    "href": "slides/02-deploy.html#your-turn",
    "title": "2 - Deploy your model",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nOpen the Model Card template, and spend a few minutes exploring how you might create a Model Card for this inspection model.\nDiscuss something you notice about the Model Card with your neighbor.\n\n\n\n\n\n\n‚àí+\n05:00"
  },
  {
    "objectID": "slides/02-deploy.html#you-can-deploy-your-model-as-a",
    "href": "slides/02-deploy.html#you-can-deploy-your-model-as-a",
    "title": "2 - Deploy your model",
    "section": "You can deploy your model as a‚Ä¶",
    "text": "You can deploy your model as a‚Ä¶\n\n\nREST API"
  },
  {
    "objectID": "slides/02-deploy.html#what-is-a-rest-api",
    "href": "slides/02-deploy.html#what-is-a-rest-api",
    "title": "2 - Deploy your model",
    "section": "What is a REST API?",
    "text": "What is a REST API?\n\nAn interface that can connect applications in a standard way"
  },
  {
    "objectID": "slides/02-deploy.html#create-a-vetiver-rest-api",
    "href": "slides/02-deploy.html#create-a-vetiver-rest-api",
    "title": "2 - Deploy your model",
    "section": "Create a vetiver REST API",
    "text": "Create a vetiver REST API\nR\n\nlibrary(plumber)\n\npr() |&gt;\n  vetiver_api(v) |&gt;\n  pr_run()\n\nPython\n\napi = VetiverAPI(v)\napi.run()"
  },
  {
    "objectID": "slides/02-deploy.html#your-turn-1",
    "href": "slides/02-deploy.html#your-turn-1",
    "title": "2 - Deploy your model",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nCreate a vetiver API for your model and run it locally.\nExplore the visual documentation.\nHow many endpoints are there?\nDiscuss what you notice with your neighbor.\n\n\n\n\n\n\n‚àí+\n07:00"
  },
  {
    "objectID": "slides/02-deploy.html#what-does-deploy-mean",
    "href": "slides/02-deploy.html#what-does-deploy-mean",
    "title": "2 - Deploy your model",
    "section": "What does ‚Äúdeploy‚Äù mean?",
    "text": "What does ‚Äúdeploy‚Äù mean?"
  },
  {
    "objectID": "slides/02-deploy.html#what-does-deploy-mean-1",
    "href": "slides/02-deploy.html#what-does-deploy-mean-1",
    "title": "2 - Deploy your model",
    "section": "What does ‚Äúdeploy‚Äù mean?",
    "text": "What does ‚Äúdeploy‚Äù mean?"
  },
  {
    "objectID": "slides/02-deploy.html#deploy-to-posit-connect",
    "href": "slides/02-deploy.html#deploy-to-posit-connect",
    "title": "2 - Deploy your model",
    "section": "Deploy to Posit Connect",
    "text": "Deploy to Posit Connect\nR\n\nvetiver_deploy_rsconnect(board, \"user.name/chicago-inspections-rstats\")\n\nPython\n\nfrom rsconnect.api import RSConnectServer\nconnect_server = RSConnectServer(url = rsc_url, api_key = api_key)\nboard = pins.board_connect(server_url = url, api_key = api_key, allow_pickle_read = True)\n\nvetiver.deploy_rsconnect(\n    connect_server = connect_server,\n    board = board,\n    pin_name = \"user.name/chicago-inspections-python\",\n)"
  },
  {
    "objectID": "slides/02-deploy.html#your-turn-2",
    "href": "slides/02-deploy.html#your-turn-2",
    "title": "2 - Deploy your model",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nDeploy your model to our Posit Connect instance.\nGive your API a vanity URL.\nSet your API as accessible to ‚ÄúAnyone‚Äù, for convenience.\nCompare the results to your local API. Is anything different?\n\n\n\n\n\n\n‚àí+\n07:00"
  },
  {
    "objectID": "slides/02-deploy.html#section",
    "href": "slides/02-deploy.html#section",
    "title": "2 - Deploy your model",
    "section": "",
    "text": "You did it! ü•≥"
  },
  {
    "objectID": "slides/02-deploy.html#how-do-you-make-a-request-of-your-new-api",
    "href": "slides/02-deploy.html#how-do-you-make-a-request-of-your-new-api",
    "title": "2 - Deploy your model",
    "section": "How do you make a request of your new API?",
    "text": "How do you make a request of your new API?\n\nRPython\n\n\n\nurl &lt;- \"https://colorado.posit.co/rsc/chicago-inspections-rstats/metadata\"\nr &lt;- httr::GET(url)\nmetadata &lt;- httr::content(r, as = \"text\", encoding = \"UTF-8\")\njsonlite::fromJSON(metadata)\n#&gt; $user\n#&gt; list()\n#&gt; \n#&gt; $version\n#&gt; [1] \"78859\"\n#&gt; \n#&gt; $url\n#&gt; [1] \"https://colorado.posit.co/rsc/content/0e1cdefd-8762-46b4-a60e-33a8b3fa7964/_rev78859/\"\n#&gt; \n#&gt; $required_pkgs\n#&gt; [1] \"parsnip\"   \"ranger\"    \"recipes\"   \"workflows\"\n\n\n\n\nimport requests\nurl = \"https://colorado.posit.co/rsc/chicago-inspections-python/metadata\" \nprint(requests.get(url).content)\n#&gt; b'{\"user\":{},\"version\":\"78841\",\"url\":\"https://colorado.posit.co/rsc/content/d08259c2-8fe0-4466-a474-0b9adbcf91dc/\",\"required_pkgs\":[\"scikit-learn\"],\"python_version\":[3,9,4,\"final\",0]}'"
  },
  {
    "objectID": "slides/02-deploy.html#how-do-you-make-a-request-of-your-new-api-1",
    "href": "slides/02-deploy.html#how-do-you-make-a-request-of-your-new-api-1",
    "title": "2 - Deploy your model",
    "section": "How do you make a request of your new API?",
    "text": "How do you make a request of your new API?\n\nPython or R packages like requests or httr (or httr2!)\ncurl\nThere is special support in vetiver for the /predict endpoint"
  },
  {
    "objectID": "slides/02-deploy.html#create-a-vetiver-endpoint",
    "href": "slides/02-deploy.html#create-a-vetiver-endpoint",
    "title": "2 - Deploy your model",
    "section": "Create a vetiver endpoint",
    "text": "Create a vetiver endpoint\nYou can treat your model API much like it is a local model in memory!\n\nRPython\n\n\n\nlibrary(vetiver)\nurl &lt;- \"https://colorado.posit.co/rsc/chicago-inspections-rstats/predict\"\nendpoint &lt;- vetiver_endpoint(url)\npredict(endpoint, slice_sample(inspect_test, n = 10))\n#&gt; # A tibble: 10 √ó 1\n#&gt;    .pred_class\n#&gt;    &lt;chr&gt;      \n#&gt;  1 FAIL       \n#&gt;  2 PASS       \n#&gt;  3 PASS       \n#&gt;  4 FAIL       \n#&gt;  5 FAIL       \n#&gt;  6 PASS       \n#&gt;  7 FAIL       \n#&gt;  8 FAIL       \n#&gt;  9 PASS       \n#&gt; 10 FAIL\n\n\n\n\nfrom vetiver.server import predict, vetiver_endpoint\nurl = \"https://colorado.posit.co/rsc/chicago-inspections-python/predict\"\nendpoint = vetiver_endpoint(url)\npredict(endpoint = endpoint, data = X_test.head(10))\n#&gt;   predict\n#&gt; 0    PASS\n#&gt; 1    FAIL\n#&gt; 2    PASS\n#&gt; 3    PASS\n#&gt; 4    PASS\n#&gt; 5    PASS\n#&gt; 6    FAIL\n#&gt; 7    FAIL\n#&gt; 8    FAIL\n#&gt; 9    PASS"
  },
  {
    "objectID": "slides/02-deploy.html#your-turn-3",
    "href": "slides/02-deploy.html#your-turn-3",
    "title": "2 - Deploy your model",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nCreate a vetiver endpoint object for your API.\nPredict with your endpoint for new data.\nOptional: call another endpoint like /ping or /metadata.\n\n\n\n\n\n\n‚àí+\n10:00"
  },
  {
    "objectID": "slides/02-deploy.html#your-turn-4",
    "href": "slides/02-deploy.html#your-turn-4",
    "title": "2 - Deploy your model",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nCreate a vetiver endpoint object for your neighbor‚Äôs API.\nPredict with your endpoint for new data.\nYou get extra credit if your neighbor‚Äôs model is in a different language than yours!\n\n\n\n\n\n\n‚àí+\n05:00"
  },
  {
    "objectID": "slides/02-deploy.html#create-a-vetiver-endpoint-1",
    "href": "slides/02-deploy.html#create-a-vetiver-endpoint-1",
    "title": "2 - Deploy your model",
    "section": "Create a vetiver endpoint",
    "text": "Create a vetiver endpoint\nWhat if your model API requires authentication?\nR\nlibrary(vetiver)\nurl &lt;- \"https://colorado.posit.co/rsc/chicago-inspections-rstats/predict\"\nendpoint &lt;- vetiver_endpoint(url)\npredict(endpoint, slice_sample(inspect_test, n = 10))\nPython\nfrom vetiver.server import predict, vetiver_endpoint\nurl = \"https://colorado.posit.co/rsc/chicago-inspections-python/predict\"\nendpoint = vetiver_endpoint(url)\npredict(endpoint = endpoint, data = ring_test)"
  },
  {
    "objectID": "slides/02-deploy.html#create-a-vetiver-endpoint-2",
    "href": "slides/02-deploy.html#create-a-vetiver-endpoint-2",
    "title": "2 - Deploy your model",
    "section": "Create a vetiver endpoint",
    "text": "Create a vetiver endpoint\nWhat if your model API requires authentication?\nR\nlibrary(vetiver)\nurl &lt;- \"https://colorado.posit.co/rsc/chicago-inspections-rstats/predict\"\nendpoint &lt;- vetiver_endpoint(url)\napiKey &lt;- Sys.getenv(\"CONNECT_API_KEY\")\npredict(endpoint, slice_sample(inspect_test, n = 10), \n        httr::add_headers(Authorization = paste(\"Key\", apiKey)))\nPython\nfrom vetiver.server import predict, vetiver_endpoint\n\nurl = \"https://colorado.posit.co/rsc/chicago-inspections-python/predict\"\nendpoint = vetiver_endpoint(url)\nh = { 'Authorization': f'Key {api_key}' }\npredict(endpoint = endpoint, data = X_test, headers = h)"
  },
  {
    "objectID": "slides/02-deploy.html#model-input-prototype-1",
    "href": "slides/02-deploy.html#model-input-prototype-1",
    "title": "2 - Deploy your model",
    "section": "Model input prototype",
    "text": "Model input prototype\nNotice that our Python model has different inputs than our R model:\n\nRPython\n\n\n\nglimpse(inspect_train)\n#&gt; Rows: 5,573\n#&gt; Columns: 6\n#&gt; $ results          &lt;fct&gt; FAIL, PASS, FAIL, FAIL, FAIL, PASS, PASS, PASS, PASS,‚Ä¶\n#&gt; $ inspection_date  &lt;date&gt; 2020-05-28, 2020-06-11, 2020-04-09, 2019-02-04, 2021‚Ä¶\n#&gt; $ aka_name         &lt;chr&gt; \"GRAND SHELL\", \"DSD DELI\", \"BP GAS\", \"LA MICHOACANA I‚Ä¶\n#&gt; $ facility_type    &lt;fct&gt; GROCERY STORE, GROCERY STORE, GROCERY STORE, RESTAURA‚Ä¶\n#&gt; $ risk             &lt;fct&gt; RISK 3 (LOW), RISK 1 (HIGH), RISK 3 (LOW), RISK 1 (HI‚Ä¶\n#&gt; $ total_violations &lt;dbl&gt; 31, 0, 25, 42, 17, 4, 17, 0, 2, 80, 94, 0, 37, 86, 66‚Ä¶\n\n\n\n\nX_train\n#&gt;      facility_type             risk  total_violations  month  year\n#&gt; 6575    RESTAURANT    RISK 1 (HIGH)              74.0     11  2022\n#&gt; 4319    RESTAURANT    RISK 1 (HIGH)               0.0     12  2021\n#&gt; 6309    RESTAURANT    RISK 1 (HIGH)               0.0     10  2022\n#&gt; 6002    RESTAURANT  RISK 2 (MEDIUM)              22.0      9  2022\n#&gt; 5262    RESTAURANT  RISK 2 (MEDIUM)              55.0      6  2022\n#&gt; ...            ...              ...               ...    ...   ...\n#&gt; 2613    RESTAURANT     RISK 3 (LOW)               0.0      6  2020\n#&gt; 787     RESTAURANT    RISK 1 (HIGH)              70.0      4  2019\n#&gt; 6129    RESTAURANT    RISK 1 (HIGH)              47.0     10  2022\n#&gt; 3533    RESTAURANT  RISK 2 (MEDIUM)               1.0      5  2021\n#&gt; 1001    RESTAURANT    RISK 1 (HIGH)               0.0      6  2019\n#&gt; \n#&gt; [5573 rows x 5 columns]"
  },
  {
    "objectID": "slides/02-deploy.html#your-turn-5",
    "href": "slides/02-deploy.html#your-turn-5",
    "title": "2 - Deploy your model",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nCall the prototype endpoints for both the Python and R model.\nHow do they compare?\n\n\n\n\n\n\n‚àí+\n05:00"
  },
  {
    "objectID": "slides/02-deploy.html#model-input-prototype-2",
    "href": "slides/02-deploy.html#model-input-prototype-2",
    "title": "2 - Deploy your model",
    "section": "Model input prototype",
    "text": "Model input prototype\n\nRPython\n\n\n\nurl &lt;- \"https://colorado.posit.co/rsc/chicago-inspections-rstats/prototype\"\nr &lt;- httr::GET(url)\nprototype &lt;- httr::content(r, as = \"text\", encoding = \"UTF-8\")\njsonlite::fromJSON(prototype)\n#&gt; $facility_type\n#&gt; $facility_type$type\n#&gt; [1] \"factor\"\n#&gt; \n#&gt; $facility_type$example\n#&gt; NULL\n#&gt; \n#&gt; $facility_type$details\n#&gt; $facility_type$details$levels\n#&gt; [1] \"BAKERY\"        \"GROCERY STORE\" \"RESTAURANT\"   \n#&gt; \n#&gt; \n#&gt; \n#&gt; $risk\n#&gt; $risk$type\n#&gt; [1] \"factor\"\n#&gt; \n#&gt; $risk$example\n#&gt; NULL\n#&gt; \n#&gt; $risk$details\n#&gt; $risk$details$levels\n#&gt; [1] \"RISK 1 (HIGH)\"   \"RISK 2 (MEDIUM)\" \"RISK 3 (LOW)\"   \n#&gt; \n#&gt; \n#&gt; \n#&gt; $total_violations\n#&gt; $total_violations$type\n#&gt; [1] \"numeric\"\n#&gt; \n#&gt; $total_violations$example\n#&gt; NULL\n#&gt; \n#&gt; $total_violations$details\n#&gt; list()\n#&gt; \n#&gt; \n#&gt; $inspection_date\n#&gt; $inspection_date$type\n#&gt; [1] \"Date\"\n#&gt; \n#&gt; $inspection_date$example\n#&gt; NULL\n#&gt; \n#&gt; $inspection_date$details\n#&gt; list()\n\n\n\n\nimport requests\nurl = \"https://colorado.posit.co/rsc/chicago-inspections-python/prototype\" \nprint(requests.get(url).content)\n#&gt; b'{\"detail\":\"Not Found\"}'"
  },
  {
    "objectID": "slides/02-deploy.html#model-input-prototype-3",
    "href": "slides/02-deploy.html#model-input-prototype-3",
    "title": "2 - Deploy your model",
    "section": "Model input prototype",
    "text": "Model input prototype\n\nIn Python, you supply the model‚Äôs input prototype via prototype_data\nIn R, the model input prototype is found automatically in most cases, but you can override this default via save_prototype\nIn both cases, it is ultimately up to you to decide what your API‚Äôs inputs should be!\nThe vetiver framework has sensible defaults but is extensible for more complex use cases"
  },
  {
    "objectID": "slides/02-deploy.html#your-turn-6",
    "href": "slides/02-deploy.html#your-turn-6",
    "title": "2 - Deploy your model",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nLet‚Äôs say you need to customize your model API‚Äôs inputs for a more complex use case.\nMake a new vetiver model object and change the input data prototype.\nRun an API locally for your new vetiver model object and explore the visual documentation. (Note that making predictions will not work now, since we haven‚Äôt updated the API behavior to match these inputs.)\nDiscuss a possible situation you might use this with your neighbor.\n\n\n\n\n\n\n‚àí+\n07:00\n\n\n\n\n\nhttps://posit-conf-2023.github.io/vetiver"
  },
  {
    "objectID": "slides/03-deploy.html#plan-for-this-workshop",
    "href": "slides/03-deploy.html#plan-for-this-workshop",
    "title": "3 - Deeper into deployment",
    "section": "Plan for this workshop",
    "text": "Plan for this workshop\n\n\nVersioning\n\nManaging change in models ‚úÖ\n\nDeploying\n\nPutting models in REST APIs üéØ\n\nMonitoring\n\nTracking model performance üëÄ"
  },
  {
    "objectID": "slides/03-deploy.html#why-docker",
    "href": "slides/03-deploy.html#why-docker",
    "title": "3 - Deeper into deployment",
    "section": "Why Docker?",
    "text": "Why Docker?\n\n\nOpen source\nReproducible\nBring your own container philosophy\n\n\n\nECR in AWS, etc huggingface"
  },
  {
    "objectID": "slides/03-deploy.html#why-docker-1",
    "href": "slides/03-deploy.html#why-docker-1",
    "title": "3 - Deeper into deployment",
    "section": "Why Docker?",
    "text": "Why Docker?"
  },
  {
    "objectID": "slides/03-deploy.html#create-docker-artifacts",
    "href": "slides/03-deploy.html#create-docker-artifacts",
    "title": "3 - Deeper into deployment",
    "section": "Create Docker artifacts",
    "text": "Create Docker artifacts\nStart with a trained and versioned model"
  },
  {
    "objectID": "slides/03-deploy.html#create-docker-artifacts-1",
    "href": "slides/03-deploy.html#create-docker-artifacts-1",
    "title": "3 - Deeper into deployment",
    "section": "Create Docker artifacts",
    "text": "Create Docker artifacts\n\n\nDockerfile\nModel dependencies, typically requirements.txt or renv.lock\nFile to serve API, typically app.py or plumber.R\n\n\nR\n\nvetiver_prepare_docker(board, \"isabel.zimmerman/inspection-results-r\", port = 8080)\n\nPython\n\nvetiver.prepare_docker(\n    board, \n    \"isabel.zimmerman/inspection-results-python\",\n    version = \"20220901T144702Z-fd402\",\n    port = 8080\n)"
  },
  {
    "objectID": "slides/03-deploy.html#build-your-container",
    "href": "slides/03-deploy.html#build-your-container",
    "title": "3 - Deeper into deployment",
    "section": "Build your container",
    "text": "Build your container\ndocker build -t inspection ."
  },
  {
    "objectID": "slides/03-deploy.html#run-your-container",
    "href": "slides/03-deploy.html#run-your-container",
    "title": "3 - Deeper into deployment",
    "section": "Run your container",
    "text": "Run your container\ndocker run --env-file .env -p 8080:8080 inspection\n\nprobably .Renv if you are in R"
  },
  {
    "objectID": "slides/03-deploy.html#make-predictions",
    "href": "slides/03-deploy.html#make-predictions",
    "title": "3 - Deeper into deployment",
    "section": "Make predictions",
    "text": "Make predictions\nR\n\nendpoint &lt;- vetiver_endpoint(\"http://0.0.0.0:8080/predict\")\npredict(endpoint, X_test)\n\nPython\n\nendpoint = vetiver.vetiver_endpoint(\"http://0.0.0.0:8080/predict\")\nvetiver.predict(endpoint=endpoint, data=X_test)"
  },
  {
    "objectID": "slides/03-deploy.html#docker-resources",
    "href": "slides/03-deploy.html#docker-resources",
    "title": "3 - Deeper into deployment",
    "section": "Docker resources",
    "text": "Docker resources\n\nEnough Docker to be Dangerous\nPython Docker\nTen simple rules for writing Dockerfiles for reproducible data science\nDocker info from Posit Solutions Engineering"
  },
  {
    "objectID": "slides/03-deploy.html#deploy-preprocessors-and-models-together-1",
    "href": "slides/03-deploy.html#deploy-preprocessors-and-models-together-1",
    "title": "3 - Deeper into deployment",
    "section": "Deploy preprocessors and models together",
    "text": "Deploy preprocessors and models together"
  },
  {
    "objectID": "slides/03-deploy.html#what-is-wrong-with-this",
    "href": "slides/03-deploy.html#what-is-wrong-with-this",
    "title": "3 - Deeper into deployment",
    "section": "What is wrong with this?",
    "text": "What is wrong with this?"
  },
  {
    "objectID": "slides/04-monitor.html#plan-for-this-workshop",
    "href": "slides/04-monitor.html#plan-for-this-workshop",
    "title": "4 - Monitor your model",
    "section": "Plan for this workshop",
    "text": "Plan for this workshop\n\n\nVersioning\n\nManaging change in models ‚úÖ\n\nDeploying\n\nPutting models in REST APIs üéØ\n\nMonitoring\n\nTracking model performance üëÄ"
  },
  {
    "objectID": "slides/04-monitor.html#data-for-model-development",
    "href": "slides/04-monitor.html#data-for-model-development",
    "title": "4 - Monitor your model",
    "section": "Data for model development",
    "text": "Data for model development\nData that you use while building a model for training/testing\nR\n\nlibrary(arrow)\npath &lt;- here::here(\"data\", \"inspections.parquet\")\ninspections &lt;- read_parquet(path)\n\nPython\n\nimport pandas as pd\ninspections = pd.read_parquet('../data/inspections.parquet')"
  },
  {
    "objectID": "slides/04-monitor.html#data-for-model-monitoring",
    "href": "slides/04-monitor.html#data-for-model-monitoring",
    "title": "4 - Monitor your model",
    "section": "Data for model monitoring",
    "text": "Data for model monitoring\nNew data that you predict on after your model deployed\nR\n\nlibrary(arrow)\npath &lt;- here::here(\"data\", \"inspections_monitoring.parquet\")\ninspections_new &lt;- read_parquet(path)\n\nPython\n\nimport pandas as pd\ninspections_new = pd.read_parquet('../data/inspections_monitoring.parquet')\ninspections_new['inspection_date'] = pd.to_datetime(inspections_new['inspection_date'])\ninspections_new['month'] = inspections_new['inspection_date'].dt.month\ninspections_new['year'] = inspections_new['inspection_date'].dt.year"
  },
  {
    "objectID": "slides/04-monitor.html#data-for-model-monitoring-1",
    "href": "slides/04-monitor.html#data-for-model-monitoring-1",
    "title": "4 - Monitor your model",
    "section": "Data for model monitoring",
    "text": "Data for model monitoring"
  },
  {
    "objectID": "slides/04-monitor.html#my-model-is-performing-well",
    "href": "slides/04-monitor.html#my-model-is-performing-well",
    "title": "4 - Monitor your model",
    "section": "My model is performing well!",
    "text": "My model is performing well!\n\nüë©üèº‚Äçüîß My model returns predictions quickly, doesn‚Äôt use too much memory or processing power, and doesn‚Äôt have outages.\n\n\n\n\n\nMetrics\n\n\n\nlatency\nmemory and CPU usage\nuptime"
  },
  {
    "objectID": "slides/04-monitor.html#my-model-is-performing-well-1",
    "href": "slides/04-monitor.html#my-model-is-performing-well-1",
    "title": "4 - Monitor your model",
    "section": "My model is performing well!",
    "text": "My model is performing well!\n\nüë©üèΩ‚Äçüî¨ My model returns predictions that are close to the true values for the predicted quantity.\n\n\n\n\n\nMetrics\n\n\n\naccuracy\nROC AUC\nF1 score\nRMSE\nlog loss"
  },
  {
    "objectID": "slides/04-monitor.html#model-drift",
    "href": "slides/04-monitor.html#model-drift",
    "title": "4 - Monitor your model",
    "section": "Model drift üìâ",
    "text": "Model drift üìâ\n\n\nDATA drift"
  },
  {
    "objectID": "slides/04-monitor.html#model-drift-1",
    "href": "slides/04-monitor.html#model-drift-1",
    "title": "4 - Monitor your model",
    "section": "Model drift üìâ",
    "text": "Model drift üìâ\n\n\nCONCEPT drift"
  },
  {
    "objectID": "slides/04-monitor.html#your-turn",
    "href": "slides/04-monitor.html#your-turn",
    "title": "4 - Monitor your model",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nUsing our Chicago data, what could be an example of data drift? Concept drift?\n\n\n\n\n\n\n‚àí+\n05:00"
  },
  {
    "objectID": "slides/04-monitor.html#learn-more-about-model-monitoring-on-tktk",
    "href": "slides/04-monitor.html#learn-more-about-model-monitoring-on-tktk",
    "title": "4 - Monitor your model",
    "section": "Learn more about model monitoring on tktk",
    "text": "Learn more about model monitoring on tktk\nCome hear Julia‚Äôs talk on reliable maintenance of ML models on tktk in tktk!"
  },
  {
    "objectID": "slides/04-monitor.html#monitor-your-models-inputs-1",
    "href": "slides/04-monitor.html#monitor-your-models-inputs-1",
    "title": "4 - Monitor your model",
    "section": "Monitor your model‚Äôs inputs",
    "text": "Monitor your model‚Äôs inputs\nTypically it is most useful to compare to your model development data1\n\nStatistical distribution of features individually\nStatistical characteristics of features as a whole\n\nApplicability scores: https://applicable.tidymodels.org/\n\n\nRemember you can store metrics of any kind from model development as metadata!"
  },
  {
    "objectID": "slides/04-monitor.html#monitor-your-models-inputs-2",
    "href": "slides/04-monitor.html#monitor-your-models-inputs-2",
    "title": "4 - Monitor your model",
    "section": "Monitor your model‚Äôs inputs",
    "text": "Monitor your model‚Äôs inputs"
  },
  {
    "objectID": "slides/04-monitor.html#monitor-your-models-inputs-3",
    "href": "slides/04-monitor.html#monitor-your-models-inputs-3",
    "title": "4 - Monitor your model",
    "section": "Monitor your model‚Äôs inputs",
    "text": "Monitor your model‚Äôs inputs"
  },
  {
    "objectID": "slides/04-monitor.html#your-turn-1",
    "href": "slides/04-monitor.html#your-turn-1",
    "title": "4 - Monitor your model",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nCreate a plot or table comparing the development vs.¬†monitoring distributions of a model input/feature.\nHow might you make this comparison if you didn‚Äôt have all the model development data available when monitoring?\nWhat summary statistics might you record during model development, to prepare for monitoring?\n\n\n\n\n\n\n‚àí+\n07:00"
  },
  {
    "objectID": "slides/04-monitor.html#monitor-your-models-outputs-1",
    "href": "slides/04-monitor.html#monitor-your-models-outputs-1",
    "title": "4 - Monitor your model",
    "section": "Monitor your model‚Äôs outputs",
    "text": "Monitor your model‚Äôs outputs\n\nIn some ML systems, you eventually get a ‚Äúreal‚Äù result after making a prediction\nIf the Chicago of Public Health used a model like this one, they would get:\n\nA prediction from their model\nA real inspection result after they did their inspection\n\nIn this case, we can monitor our model‚Äôs statistical performance\n\nIf you don‚Äôt ever get a ‚Äúreal‚Äù result, you can still monitor the distribution of your outputs"
  },
  {
    "objectID": "slides/04-monitor.html#monitor-your-models-outputs-2",
    "href": "slides/04-monitor.html#monitor-your-models-outputs-2",
    "title": "4 - Monitor your model",
    "section": "Monitor your model‚Äôs outputs",
    "text": "Monitor your model‚Äôs outputs\nPython\n\nfrom vetiver import vetiver_endpoint, predict, compute_metrics, plot_metrics\nfrom sklearn.metrics import recall_score, accuracy_score\nfrom datetime import timedelta\n\nurl = \"https://colorado.posit.co/rsc/chicago-inspections-python/predict\"\nendpoint = vetiver_endpoint(url)\ninspections_new[\"preds\"] = predict(endpoint = url, data = inspections_new.drop(columns = [\"results\", \"aka_name\", \"inspection_date\"]))\n\ninspections_new[\"preds\"] = inspections_new[\"preds\"].map({\"PASS\": 1, \"FAIL\": 0})\ninspections_new[\"results\"] = inspections_new[\"results\"].map({\"PASS\": 1, \"FAIL\": 0})\n\ntd = timedelta(weeks = 4)\nmetric_set = [accuracy_score, recall_score]\n\nm = compute_metrics(\n    data = inspections_new,\n    date_var = \"inspection_date\", \n    period = td,\n    metric_set = metric_set,\n    truth = \"results\",\n    estimate = \"preds\"\n  )\n  \nplot_metrics(m).show()"
  },
  {
    "objectID": "slides/04-monitor.html#monitor-your-models-outputs-2-output",
    "href": "slides/04-monitor.html#monitor-your-models-outputs-2-output",
    "title": "4 - Monitor your model",
    "section": "Monitor your model‚Äôs outputs",
    "text": "Monitor your model‚Äôs outputs"
  },
  {
    "objectID": "slides/04-monitor.html#monitor-your-models-outputs-3",
    "href": "slides/04-monitor.html#monitor-your-models-outputs-3",
    "title": "4 - Monitor your model",
    "section": "Monitor your model‚Äôs outputs",
    "text": "Monitor your model‚Äôs outputs\nR\n\nlibrary(vetiver)\nlibrary(tidymodels)\nlibrary(workflows)\nurl &lt;- \"https://colorado.posit.co/rsc/chicago-inspections-rstats/predict\"\nendpoint &lt;- vetiver_endpoint(url)\n\naugment(endpoint, new_data = inspections_new) |&gt;\n  mutate(.pred_class = as.factor(.pred_class)) |&gt; \n  vetiver_compute_metrics(\n    inspection_date, \n    \"month\", \n    results, \n    .pred_class,\n    metric_set = metric_set(accuracy, sensitivity)\n  ) |&gt; \n  vetiver_plot_metrics()"
  },
  {
    "objectID": "slides/04-monitor.html#monitor-your-models-outputs-3-output",
    "href": "slides/04-monitor.html#monitor-your-models-outputs-3-output",
    "title": "4 - Monitor your model",
    "section": "Monitor your model‚Äôs outputs",
    "text": "Monitor your model‚Äôs outputs"
  },
  {
    "objectID": "slides/04-monitor.html#your-turn-2",
    "href": "slides/04-monitor.html#your-turn-2",
    "title": "4 - Monitor your model",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nUse the functions for metrics monitoring from vetiver to create a monitoring visualization.\nChoose a different set of metrics or time aggregation.\nNote that there are functions for using pins as a way to version and update monitoring results too!\n\n\n\n\n\n\n‚àí+\n05:00"
  },
  {
    "objectID": "slides/04-monitor.html#feedback-loops-1",
    "href": "slides/04-monitor.html#feedback-loops-1",
    "title": "4 - Monitor your model",
    "section": "Feedback loops üîÅ",
    "text": "Feedback loops üîÅ\n\nUsers take some action as a result of a prediction\nUsers rate or correct the quality of a prediction\nProduce annotations (crowdsource or expert)\nProduce feedback automatically\n\n\nBuilding Machine Learning Pipelines by Hapke & Nelson"
  },
  {
    "objectID": "slides/04-monitor.html#your-turn-3",
    "href": "slides/04-monitor.html#your-turn-3",
    "title": "4 - Monitor your model",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nWhat is a possible feedback loop for the Chicago inspections data?\nDo you think your example would be harmful or helpful?\n\n\n\n\n\n\n‚àí+\n05:00"
  },
  {
    "objectID": "slides/04-monitor.html#ml-metrics-organizational-outcomes",
    "href": "slides/04-monitor.html#ml-metrics-organizational-outcomes",
    "title": "4 - Monitor your model",
    "section": "ML metrics ‚û°Ô∏è organizational outcomes",
    "text": "ML metrics ‚û°Ô∏è organizational outcomes\n\nAre machine learning metrics like F1 score or accuracy what matter to your organization?\nConsider how ML metrics are related to important outcomes or KPIs for your business or org\nThere isn‚Äôt always a 1-to-1 mapping üòî\nYou can partner with stakeholders to monitor what‚Äôs truly important about your model"
  },
  {
    "objectID": "slides/04-monitor.html#your-turn-4",
    "href": "slides/04-monitor.html#your-turn-4",
    "title": "4 - Monitor your model",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nLet‚Äôs say that the most important organizational outcome for the Chicago Department of Public Health is what proportion of failed inspections were predicted to fail.\nIf ‚Äúfail‚Äù is the event we are predicting, this is the sensitivity.\nCompute this quantity with the monitoring data, and aggregate by week/month or facility type.\nFor extra credit, make a visualization showing your results.\n\n\n\n\n\n\n‚àí+\n07:00"
  },
  {
    "objectID": "slides/04-monitor.html#ml-metrics-organizational-outcomes-1",
    "href": "slides/04-monitor.html#ml-metrics-organizational-outcomes-1",
    "title": "4 - Monitor your model",
    "section": "ML metrics ‚û°Ô∏è organizational outcomes",
    "text": "ML metrics ‚û°Ô∏è organizational outcomes\n\nRPython\n\n\n\naugment(endpoint, inspections_new) |&gt; \n  mutate(.pred_class = as.factor(.pred_class)) |&gt; \n  group_by(facility_type) |&gt; \n  sensitivity(results, .pred_class)\n#&gt; # A tibble: 3 √ó 4\n#&gt;   facility_type .metric     .estimator .estimate\n#&gt;   &lt;fct&gt;         &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt;\n#&gt; 1 BAKERY        sensitivity binary        0     \n#&gt; 2 GROCERY STORE sensitivity binary        0.0110\n#&gt; 3 RESTAURANT    sensitivity binary        0.0151\n\n\n\n\nby_facility_type = pd.DataFrame()\nfor metric in metric_set:\n    by_facility_type[metric.__qualname__] = inspections_new.groupby(\"facility_type\")\\\n        .apply(lambda x: metric(y_pred=x[\"preds\"], y_true=x[\"results\"]))\nby_facility_type\n#&gt;                accuracy_score  recall_score\n#&gt; facility_type                              \n#&gt; BAKERY               0.239437      0.070175\n#&gt; GROCERY STORE        0.281843      0.075540\n#&gt; RESTAURANT           0.283458      0.074897"
  },
  {
    "objectID": "slides/04-monitor.html#what-is-going-on-with-these-inspections",
    "href": "slides/04-monitor.html#what-is-going-on-with-these-inspections",
    "title": "4 - Monitor your model",
    "section": "What is going on with these inspections?! üò≥",
    "text": "What is going on with these inspections?! üò≥"
  },
  {
    "objectID": "slides/04-monitor.html#possible-model-monitoring-artifacts",
    "href": "slides/04-monitor.html#possible-model-monitoring-artifacts",
    "title": "4 - Monitor your model",
    "section": "Possible model monitoring artifacts",
    "text": "Possible model monitoring artifacts\n\nAdhoc analysis that you post in Slack\nReport that you share in Google Drive\nFully automated dashboard published to Posit Connect\n\n\n5 Levels of MLOps Maturity"
  },
  {
    "objectID": "slides/04-monitor.html#possible-model-monitoring-artifacts-1",
    "href": "slides/04-monitor.html#possible-model-monitoring-artifacts-1",
    "title": "4 - Monitor your model",
    "section": "Possible model monitoring artifacts",
    "text": "Possible model monitoring artifacts"
  },
  {
    "objectID": "slides/04-monitor.html#your-turn-5",
    "href": "slides/04-monitor.html#your-turn-5",
    "title": "4 - Monitor your model",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nCreate a Quarto report or R Markdown dashboard for model monitoring.\nKeep in mind that we are seeing some real ‚ú®problems‚ú® with this model we trained.\nPublish your document to Connect.\n\n\n\n\n\n\n‚àí+\n15:00"
  },
  {
    "objectID": "slides/04-monitor.html#section",
    "href": "slides/04-monitor.html#section",
    "title": "4 - Monitor your model",
    "section": "",
    "text": "We made it! üéâ"
  },
  {
    "objectID": "slides/04-monitor.html#your-turn-6",
    "href": "slides/04-monitor.html#your-turn-6",
    "title": "4 - Monitor your model",
    "section": "Your turn üè∫",
    "text": "Your turn üè∫\n\n\n\nActivity\n\n\nWhat is one thing you learned that surprised you?\nWhat is one thing you learned that you plan to use?\n\n\n\n\n\n\n‚àí+\n05:00"
  },
  {
    "objectID": "slides/04-monitor.html#resources-to-keep-learning",
    "href": "slides/04-monitor.html#resources-to-keep-learning",
    "title": "4 - Monitor your model",
    "section": "Resources to keep learning",
    "text": "Resources to keep learning\n\nDocumentation at https://vetiver.rstudio.com/\nIsabel‚Äôs talk from rstudio::conf() 2022 on Demystifying MLOps\nEnd-to-end demos from Posit Solution Engineering in R and Python\nAre you on the right track with your MLOps system? Use the rubric in ‚ÄúThe ML Test Score: A Rubric for ML Production Readiness and Technical Debt Reduction‚Äù by Breck et al (2017)\nWant to learn about how MLOps is being practiced? Read one of our favorite üòç papers of the last year, ‚ÄúOperationalizing Machine Learning: An Interview Study‚Äù by Shankar et al (20222)\n\n\nFollow Posit and/or us on your preferred social media for updates!"
  }
]